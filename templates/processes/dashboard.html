{% extends 'base.html' %}

{% block title %}Dashboard - {{ cervejaria.name }}{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
    <div>
        <h2>Dashboard - An√°lise de Performance</h2>
        <p style="color: #999; margin-top: 0.5rem;">{{ cervejaria.name }} | √öltima atualiza√ß√£o: Agora</p>
    </div>
    <div style="display: flex; gap: 1rem;">
        <a href="{% url 'brewery:detail' cervejaria.id %}" class="btn btn-secondary">‚Üê Voltar</a>
        <a href="{% url 'process:dre' cervejaria.id %}" class="btn btn-success">üìä Ver DRE</a>
    </div>
</div>

<div class="content">
    <!-- ===== SE√á√ÉO 1: KPIs PRINCIPAIS ===== -->
    <div style="margin-bottom: 2.5rem;">
        <h3 style="color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 0.5rem;">üìä Resumo Geral</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
            <div class="card" style="border-left: 5px solid #3498db; background: linear-gradient(135deg, #ecf0f1 0%, #ffffff 100%);">
                <h3 style="margin: 0 0 0.5rem 0; color: #3498db; display: flex; align-items: center; gap: 0.5rem;">üìã Processos</h3>
                <p style="font-size: 2.5rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ total_processos }}</p>
                <p style="color: #666; margin: 0; font-size: 0.9rem;">SOPs cadastrados e ativos</p>
            </div>

            <div class="card" style="border-left: 5px solid #28a745; background: linear-gradient(135deg, #eafce8 0%, #ffffff 100%);">
                <h3 style="margin: 0 0 0.5rem 0; color: #28a745; display: flex; align-items: center; gap: 0.5rem;">‚ñ∂Ô∏è Execu√ß√µes</h3>
                <p style="font-size: 2.5rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ total_execucoes }}</p>
                <small style="color: #666;">‚úì {{ execucoes_concluidas }} conclu√≠das</small>
            </div>

            <div class="card" style="border-left: 5px solid #9b59b6; background: linear-gradient(135deg, #f4ecf7 0%, #ffffff 100%);">
                <h3 style="margin: 0 0 0.5rem 0; color: #9b59b6; display: flex; align-items: center; gap: 0.5rem;">üìà Taxa Conformidade</h3>
                <p style="font-size: 2.5rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ taxa_conformidade_geral|floatformat:1 }}%</p>
                <small style="color: #666;">Processos sem n√£o-conformidades ativas</small>
            </div>

            <div class="card" style="border-left: 5px solid #3498db; background: linear-gradient(135deg, #eef5fb 0%, #ffffff 100%);">
                <h3 style="margin: 0 0 0.5rem 0; color: #3498db; display: flex; align-items: center; gap: 0.5rem;">‚úì HACCP Conformidade</h3>
                <p style="font-size: 2.5rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ taxa_conformidade_haccp|floatformat:1 }}%</p>
                <small style="color: #666;">{{ total_registros_haccp }} registros | ‚ö†Ô∏è {{ registros_nao_conformes }} desvios</small>
            </div>
        </div>
    </div>

    <!-- ===== SE√á√ÉO 1.5: GR√ÅFICOS INTERATIVOS PLOTLY ===== -->
    <!-- ===== SE√á√ÉO 1.5: GR√ÅFICOS INTERATIVOS ===== -->
    <div style="margin-bottom: 2.5rem;">
        <h3 style="color: #2c3e50; border-bottom: 3px solid #9b59b6; padding-bottom: 0.5rem;">üéØ Metas e Objetivos</h3>
        
        {% if metas %}
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                {% for meta in metas %}
                <div class="card" style="border: 2px solid #9b59b6;">
                    <h4 style="margin: 0 0 0.5rem 0; color: #9b59b6;">{{ meta.nome }}</h4>
                    <p style="color: #666; font-size: 0.9rem; margin: 0 0 1rem 0;">{{ meta.get_tipo_display }}</p>
                    
                    <div style="margin: 1rem 0;">
                        <div style="background-color: #ecf0f1; border-radius: 8px; height: 20px; overflow: hidden;">
                            <div style="background: linear-gradient(90deg, #9b59b6, #8e44ad); height: 100%; width: {{ meta.percentual }}%; transition: width 0.3s ease;"></div>
                        </div>
                        <p style="margin: 0.5rem 0 0 0; font-size: 0.85rem; color: #666;">
                            <strong>{{ meta.percentual|floatformat:1 }}%</strong> - {{ meta.valor_atual|floatformat:2 }} / {{ meta.valor_meta|floatformat:2 }} {{ meta.unidade }}
                        </p>
                    </div>
                    
                    <p style="color: #999; font-size: 0.8rem; margin: 1rem 0 0 0;">
                        {{ meta.data_inicio|date:"d/m/Y" }} a {{ meta.data_fim|date:"d/m/Y" }}
                    </p>
                </div>
                {% endfor %}
            </div>
            
            <div style="margin-top: 1.5rem;">
                <a href="{% url 'process:meta_list' cervejaria.id %}" class="btn btn-secondary">Gerenciar Metas</a>
            </div>
        {% else %}
            <div style="background: #f0f8ff; padding: 2rem; border-radius: 8px; text-align: center; border: 2px dashed #9b59b6; margin-top: 1.5rem;">
                <p style="color: #2c3e50; font-size: 1rem; margin: 0;">
                    üìà Nenhuma meta criada ainda
                </p>
                <p style="color: #7f8c8d; font-size: 0.95rem; margin: 0.5rem 0 1rem 0;">
                    Crie metas para acompanhar seus objetivos de neg√≥cio
                </p>
                <a href="{% url 'process:meta_list' cervejaria.id %}" class="btn btn-secondary">Criar Metas</a>
            </div>
        {% endif %}
    </div>

    <!-- ===== SE√á√ÉO 1.6: GR√ÅFICOS ANAL√çTICOS PLOTLY ===== -->
    <div style="margin-bottom: 2.5rem;">
        <h3 style="color: #2c3e50; border-bottom: 3px solid #1abc9c; padding-bottom: 0.5rem;">üìä Gr√°ficos Anal√≠ticos</h3>
        
        <div style="margin-top: 1.5rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(600px, 1fr)); gap: 2rem;">
            <!-- Gr√°fico: Metas Compara√ß√£o -->
            {% if grafico_metas_comparacao %}
            <div style="background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div id="grafico-metas-comparacao"></div>
                <script>
                    var dados_metas = {{ grafico_metas_comparacao|safe }};
                    setTimeout(function() {
                        if (Object.keys(dados_metas).length > 0 && typeof Plotly !== 'undefined') {
                            Plotly.newPlot('grafico-metas-comparacao', dados_metas.data, dados_metas.layout, {responsive: true});
                        }
                    }, 100);
                </script>
            </div>
            {% endif %}
            
            <!-- Gr√°fico: Metas Progresso -->
            {% if grafico_metas_progresso %}
            <div style="background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div id="grafico-metas-progresso"></div>
                <script>
                    var dados_progresso = {{ grafico_metas_progresso|safe }};
                    setTimeout(function() {
                        if (Object.keys(dados_progresso).length > 0 && typeof Plotly !== 'undefined') {
                            Plotly.newPlot('grafico-metas-progresso', dados_progresso.data, dados_progresso.layout, {responsive: true});
                        }
                    }, 100);
                </script>
            </div>
            {% endif %}
        </div>
        
        <div style="margin-top: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(600px, 1fr)); gap: 2rem;">
            <!-- Gr√°fico: NCs por Severidade -->
            {% if grafico_nc_severidade %}
            <div style="background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div id="grafico-nc-severidade"></div>
                <script>
                    var dados_nc = {{ grafico_nc_severidade|safe }};
                    setTimeout(function() {
                        if (Object.keys(dados_nc).length > 0 && typeof Plotly !== 'undefined') {
                            Plotly.newPlot('grafico-nc-severidade', dados_nc.data, dados_nc.layout, {responsive: true});
                        }
                    }, 100);
                </script>
            </div>
            {% endif %}
            
            <!-- Gr√°fico: Tend√™ncia NCs -->
            {% if grafico_nc_tendencia %}
            <div style="background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div id="grafico-nc-tendencia"></div>
                <script>
                    var dados_tendencia = {{ grafico_nc_tendencia|safe }};
                    setTimeout(function() {
                        if (Object.keys(dados_tendencia).length > 0 && typeof Plotly !== 'undefined') {
                            Plotly.newPlot('grafico-nc-tendencia', dados_tendencia.data, dados_tendencia.layout, {responsive: true});
                        }
                    }, 100);
                </script>
            </div>
            {% endif %}
        </div>
        
        <div style="margin-top: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(600px, 1fr)); gap: 2rem;">
            <!-- Gr√°fico: Conformidade HACCP -->
            {% if grafico_haccp %}
            <div style="background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div id="grafico-haccp"></div>
                <script>
                    var dados_haccp = {{ grafico_haccp|safe }};
                    setTimeout(function() {
                        if (Object.keys(dados_haccp).length > 0 && typeof Plotly !== 'undefined') {
                            Plotly.newPlot('grafico-haccp', dados_haccp.data, dados_haccp.layout, {responsive: true});
                        }
                    }, 100);
                </script>
            </div>
            {% endif %}
            
            <!-- Gr√°fico: Status Execu√ß√µes -->
            {% if grafico_execucoes %}
            <div style="background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div id="grafico-execucoes"></div>
                <script>
                    var dados_exec = {{ grafico_execucoes|safe }};
                    setTimeout(function() {
                        if (Object.keys(dados_exec).length > 0 && typeof Plotly !== 'undefined') {
                            Plotly.newPlot('grafico-execucoes', dados_exec.data, dados_exec.layout, {responsive: true});
                        }
                    }, 100);
                </script>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- ===== SE√á√ÉO 2: AN√ÅLISE DE TEND√äNCIAS NC ===== -->
    <div style="margin-bottom: 2.5rem; background: #fefaf0; padding: 1.5rem; border-radius: 8px; border-left: 5px solid #ff9800;">
        <h3 style="color: #e67e22; margin-top: 0;">üìâ An√°lise de Tend√™ncia - N√£o Conformidades</h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-top: 1rem;">
            <div class="card">
                <h4 style="margin: 0 0 1rem 0; color: #ff9800;">√öltimos 7 dias</h4>
                <p style="font-size: 2rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ ncs_7_dias }}</p>
                <p style="color: #666; margin: 0; font-size: 0.9rem;">NCs criadas</p>
            </div>

            <div class="card">
                <h4 style="margin: 0 0 1rem 0; color: #ff9800;">Dias 7-14</h4>
                <p style="font-size: 2rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ ncs_14_dias }}</p>
                <p style="color: #666; margin: 0; font-size: 0.9rem;">NCs criadas</p>
            </div>

            <div class="card">
                <h4 style="margin: 0 0 1rem 0; color: #ff9800;">Dias 14-30</h4>
                <p style="font-size: 2rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ ncs_30_dias }}</p>
                <p style="color: #666; margin: 0; font-size: 0.9rem;">NCs criadas</p>
            </div>

            <div class="card" style="border: 2px solid #ff9800; background: {% if tendencia_nc == 'crescente' %}#ffe8d6{% elif tendencia_nc == 'decrescente' %}#d4edda{% else %}#f0f0f0{% endif %};">
                <h4 style="margin: 0 0 1rem 0; color: #ff9800;">üìä Tend√™ncia</h4>
                <p style="font-size: 2rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">
                    {% if tendencia_nc == 'crescente' %}
                        ‚¨ÜÔ∏è Crescente
                    {% elif tendencia_nc == 'decrescente' %}
                        ‚¨áÔ∏è Decrescente
                    {% else %}
                        ‚û°Ô∏è Est√°vel
                    {% endif %}
                </p>
                <p style="color: #666; margin: 0; font-size: 0.85rem;">
                    {% if tendencia_nc == 'crescente' %}
                        <span style="color: #dc3545;"><strong>‚ö†Ô∏è Aten√ß√£o:</strong> NCs aumentando</span>
                    {% elif tendencia_nc == 'decrescente' %}
                        <span style="color: #28a745;"><strong>‚úì Bom:</strong> NCs diminuindo</span>
                    {% else %}
                        <span style="color: #666;"><strong>‚ÑπÔ∏è</strong> NCs est√°veis</span>
                    {% endif %}
                </p>
            </div>
        </div>

        <div style="margin-top: 1.5rem;">
            <h4>Distribui√ß√£o por Severidade:</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem;">
                <div style="background: #dc3545; color: white; padding: 1rem; border-radius: 4px; text-align: center;">
                    <p style="margin: 0; font-size: 1.8rem; font-weight: bold;">{{ ncs_critica }}</p>
                    <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">üî¥ Cr√≠ticas</p>
                </div>
                <div style="background: #ff9800; color: white; padding: 1rem; border-radius: 4px; text-align: center;">
                    <p style="margin: 0; font-size: 1.8rem; font-weight: bold;">{{ ncs_alta }}</p>
                    <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">üü† Altas</p>
                </div>
                <div style="background: #ffc107; color: #333; padding: 1rem; border-radius: 4px; text-align: center;">
                    <p style="margin: 0; font-size: 1.8rem; font-weight: bold;">{{ ncs_media }}</p>
                    <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">üü° M√©dias</p>
                </div>
                <div style="background: #28a745; color: white; padding: 1rem; border-radius: 4px; text-align: center;">
                    <p style="margin: 0; font-size: 1.8rem; font-weight: bold;">{{ ncs_baixa }}</p>
                    <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">üü¢ Baixas</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== SE√á√ÉO 3: AN√ÅLISE DE TEND√äNCIAS HACCP ===== -->
    <div style="margin-bottom: 2.5rem; background: #f0f8ff; padding: 1.5rem; border-radius: 8px; border-left: 5px solid #3498db;">
        <h3 style="color: #2980b9; margin-top: 0;">üìä An√°lise de Tend√™ncia - Monitoramento HACCP</h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-top: 1rem;">
            <div class="card">
                <h4 style="margin: 0 0 1rem 0; color: #3498db;">√öltimos 7 dias</h4>
                <p style="font-size: 2rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ desvios_7_dias }}</p>
                <p style="color: #666; margin: 0; font-size: 0.9rem;">Registros fora de conformidade</p>
            </div>

            <div class="card">
                <h4 style="margin: 0 0 1rem 0; color: #3498db;">Dias 7-14</h4>
                <p style="font-size: 2rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ desvios_14_dias }}</p>
                <p style="color: #666; margin: 0; font-size: 0.9rem;">Registros fora de conformidade</p>
            </div>

            <div class="card">
                <h4 style="margin: 0 0 1rem 0; color: #3498db;">Dias 14-30</h4>
                <p style="font-size: 2rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ desvios_30_dias }}</p>
                <p style="color: #666; margin: 0; font-size: 0.9rem;">Registros fora de conformidade</p>
            </div>

            <div class="card" style="border: 2px solid #3498db; background: {% if tendencia_haccp == 'piorando' %}#ffe8d6{% elif tendencia_haccp == 'melhorando' %}#d4edda{% else %}#f0f0f0{% endif %};">
                <h4 style="margin: 0 0 1rem 0; color: #3498db;">üìà Tend√™ncia</h4>
                <p style="font-size: 2rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">
                    {% if tendencia_haccp == 'piorando' %}
                        ‚¨ÜÔ∏è Piorando
                    {% elif tendencia_haccp == 'melhorando' %}
                        ‚¨áÔ∏è Melhorando
                    {% else %}
                        ‚û°Ô∏è Est√°vel
                    {% endif %}
                </p>
                <p style="color: #666; margin: 0; font-size: 0.85rem;">
                    {% if tendencia_haccp == 'piorando' %}
                        <span style="color: #dc3545;"><strong>‚ö†Ô∏è Cr√≠tico:</strong> Desvios aumentando</span>
                    {% elif tendencia_haccp == 'melhorando' %}
                        <span style="color: #28a745;"><strong>‚úì Excelente:</strong> Controle melhorando</span>
                    {% else %}
                        <span style="color: #666;"><strong>‚ÑπÔ∏è</strong> Desvios est√°veis</span>
                    {% endif %}
                </p>
            </div>
        </div>
    </div>

    <!-- ===== SE√á√ÉO 4: STATUS GERAL ===== -->
    <div style="margin-bottom: 2.5rem;">
        <h3 style="color: #2c3e50; border-bottom: 3px solid #e74c3c; padding-bottom: 0.5rem;">‚ö° Status Atual</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
            <div class="card" style="border-left: 5px solid #e74c3c; background: #fadbd8;">
                <h4 style="margin: 0 0 0.5rem 0; color: #e74c3c; display: flex; align-items: center; gap: 0.5rem;">‚ö†Ô∏è NCs Ativas</h4>
                <p style="font-size: 2.5rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ ncs_ativas }}</p>
                <small style="color: #666;">
                    {% if ncs_criticas_ativas > 0 %}
                        üî¥ {{ ncs_criticas_ativas }} cr√≠ticas - A√á√ÉO IMEDIATA!
                    {% else %}
                        ‚úì Sem cr√≠ticas
                    {% endif %}
                </small>
            </div>

            <div class="card" style="border-left: 5px solid #f39c12; background: #fef5e7;">
                <h4 style="margin: 0 0 0.5rem 0; color: #f39c12; display: flex; align-items: center; gap: 0.5rem;">üîß CAPAs Pendentes</h4>
                <p style="font-size: 2.5rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">{{ capas_pendentes }}</p>
                <small style="color: #666;">‚úì {{ capas_concluidas }} conclu√≠das</small>
            </div>

            <div class="card" style="border-left: 5px solid #27ae60; background: #d5f4e6;">
                <h4 style="margin: 0 0 0.5rem 0; color: #27ae60; display: flex; align-items: center; gap: 0.5rem;">üèÜ Performance</h4>
                <p style="font-size: 2.5rem; margin: 1rem 0 0.5rem 0; font-weight: bold;">
                    {% if taxa_conformidade_geral > 90 %}
                        A+
                    {% elif taxa_conformidade_geral > 80 %}
                        A
                    {% elif taxa_conformidade_geral > 70 %}
                        B+
                    {% else %}
                        C
                    {% endif %}
                </p>
                <small style="color: #666;">Sistema com {{ taxa_conformidade_geral|floatformat:0 }}% de conformidade</small>
            </div>
        </div>
    </div>

    <!-- ===== SE√á√ÉO 5: NCs N√ÉO RESOLVIDAS ===== -->
    {% if ncs_antigas %}
    <div style="margin-bottom: 2.5rem;">
        <h3 style="color: #c0392b; border-bottom: 3px solid #c0392b; padding-bottom: 0.5rem;">üö® NCs Pendentes h√° Mais Tempo</h3>
        <div style="margin-top: 1rem;">
            {% for nc in ncs_antigas %}
            <div class="card" style="margin-bottom: 1rem; border-left: 4px solid {% if nc.severidade == 'critica' %}#dc3545{% elif nc.severidade == 'alta' %}#ff9800{% elif nc.severidade == 'media' %}#ffc107{% else %}#28a745{% endif %};">
                <div style="display: flex; justify-content: space-between; align-items: start;">
                    <div>
                        <h4 style="margin: 0 0 0.5rem 0;">NC-{{ nc.id }}: {{ nc.titulo }}</h4>
                        <p style="color: #666; margin: 0 0 0.5rem 0; font-size: 0.9rem;">{{ nc.descricao|truncatewords:20 }}</p>
                        <small style="color: #999;">Criada: {{ nc.data_criacao|date:"d/m/Y H:i" }} (h√° {{ nc.data_criacao|timesince }})</small>
                    </div>
                    <a href="{% url 'process:detalhe_nc' cervejaria.id nc.id %}" class="btn btn-sm btn-primary" style="white-space: nowrap;">Ver Detalhes</a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- ===== SE√á√ÉO 6: √öLTIMAS ATIVIDADES ===== -->
    <div style="margin-bottom: 2.5rem;">
        <h3 style="color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 0.5rem;">üìã √öltimas N√£o Conformidades</h3>
        {% if ultimas_ncs %}
            <table class="table" style="margin-top: 1rem;">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>T√≠tulo</th>
                        <th>Severidade</th>
                        <th>Status</th>
                        <th>Criada em</th>
                        <th>A√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    {% for nc in ultimas_ncs %}
                    <tr>
                        <td><strong>NC-{{ nc.id }}</strong></td>
                        <td>{{ nc.titulo|truncatewords:5 }}</td>
                        <td>
                            {% if nc.severidade == 'critica' %}
                                <span class="badge" style="background: #dc3545; color: white; padding: 0.5rem 1rem;">üî¥ Cr√≠tica</span>
                            {% elif nc.severidade == 'alta' %}
                                <span class="badge" style="background: #ff9800; color: white; padding: 0.5rem 1rem;">üü† Alta</span>
                            {% elif nc.severidade == 'media' %}
                                <span class="badge" style="background: #ffc107; color: #333; padding: 0.5rem 1rem;">üü° M√©dia</span>
                            {% else %}
                                <span class="badge" style="background: #28a745; color: white; padding: 0.5rem 1rem;">üü¢ Baixa</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if nc.status == 'aberta' %}
                                <span style="color: #dc3545; font-weight: bold;">üî¥ Aberta</span>
                            {% elif nc.status == 'em_analise' %}
                                <span style="color: #ff9800; font-weight: bold;">üü† Em An√°lise</span>
                            {% elif nc.status == 'em_correcao' %}
                                <span style="color: #ffc107; font-weight: bold;">üü° Em Corre√ß√£o</span>
                            {% else %}
                                <span style="color: #28a745; font-weight: bold;">‚úì Fechada</span>
                            {% endif %}
                        </td>
                        <td>{{ nc.data_criacao|date:"d/m/Y" }}</td>
                        <td>
                            <a href="{% url 'process:detalhe_nc' cervejaria.id nc.id %}" style="color: #3498db; text-decoration: none; font-weight: bold;">‚Üí</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <div class="card" style="text-align: center; padding: 2rem; background: #d4edda; border: 2px solid #28a745;">
                <p style="color: #155724; margin: 0; font-size: 1.1rem;">‚úì Nenhuma n√£o conformidade registrada!</p>
            </div>
        {% endif %}
    </div>

    <!-- Links r√°pidos -->
    <div style="margin-top: 2rem; background: #ecf0f1; padding: 1.5rem; border-radius: 8px;">
        <h3 style="margin-top: 0; color: #2c3e50;">‚ö° A√ß√µes R√°pidas</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem;">
            <a href="{% url 'process:nao_conformidades' cervejaria.id %}" class="btn btn-secondary" style="text-align: center; padding: 1rem;">üìã Gerenciar NCs</a>
            <a href="{% url 'process:pontos_criticos_cervejaria' cervejaria.id %}" class="btn btn-secondary" style="text-align: center; padding: 1rem;">üéØ Pontos HACCP</a>
            <a href="{% url 'process:dre' cervejaria.id %}" class="btn btn-secondary" style="text-align: center; padding: 1rem;">üìä Ver Relat√≥rio DRE</a>
            <a href="{% url 'brewery:detail' cervejaria.id %}" class="btn btn-secondary" style="text-align: center; padding: 1rem;">‚Üê Voltar para Cervejaria</a>
        </div>
    </div>
</div>
{% endblock %}
